worker_processes auto;

events {
    worker_connections 1024;
}

http {
    include       /etc/nginx/mime.types;
    default_type  application/octet-stream;

    # 로그 포맷 (캐시 상태 포함)
    log_format cache_log '$remote_addr - [$time_local] '
                         '"$request" $status '
                         'Cache:$upstream_cache_status '
                         'Time:${request_time}s';

    access_log /var/log/nginx/access.log cache_log;

    # 캐시 저장소 설정
    proxy_cache_path /var/cache/nginx/proxy_cache
                     levels=1:2
                     keys_zone=my_cache:10m
                     max_size=100m
                     inactive=60m
                     use_temp_path=off;

    include /etc/nginx/conf.d/*.conf;
}
